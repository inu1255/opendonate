webpackJsonp([3],{mD5l:function(t,e){},mP9T:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,n,i,s,l=a("K6ED"),o=a.n(l),u=a("BO1k"),c=a.n(u),p=a("Xxa5"),v=a.n(p),d=a("mvHQ"),m=a.n(d),_=a("exGp"),f=a.n(_),h=a("Zx67"),y=a.n(h),b=a("Zrlr"),w=a.n(b),x=a("wxAW"),k=a.n(x),g=a("zwoO"),q=a.n(g),$=a("Pf15"),O=a.n($),T=a("7+uW"),z=a("443i"),E=(a("ipus"),a("JaHG"));var N,P,S,j,D,J,A=(r=Object(z.a)(),n=E.a.loading(),r((s=function(t){function e(){var t,a,r,n;w()(this,e);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=r=q()(this,(t=e.__proto__||y()(e)).call.apply(t,[this].concat(s))),r.loading=!1,r.query=E.a.query({type:null,state:0,ret:null,r:"day"},!0),r.payType=["支付宝","微信"],r.stateType=["待审核","支付失败","支付成功"],r.sendType=["待发货","发货失败","发货成功","手动发货"],r.columns=[{title:"ID",name:"id",width:64},{title:"IP",name:"ip",width:128},{title:"客户端",name:"ua",sortable:!0,width:84},{title:"项目名称",name:"title",sortable:!0,width:128},{title:"支付方式",name:"type",sortable:!0,width:84},{title:"价格",name:"price",sortable:!0,width:64},{title:"创建时间",name:"create_at",sortable:!0,width:96},{title:"已支付",name:"pay_at",sortable:!0,width:84},{title:"状态",name:"state",width:84},{title:"发货",name:"ret",width:84},{title:"附加信息",name:"ext"},{title:"操作",name:"tools",width:48}],r.list=[],r.sort={name:"create_at",order:"desc"},n=a,q()(r,n)}return O()(e,t),k()(e,[{key:"format",value:function(t){t.price&&(t.price/=100),t.os=E.a.os(t.ua)}},{key:"onOk",value:function(){var t=f()(v.a.mark(function t(e,a,r){var n,i;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r&&e.app_id&&e.ret>1)){t.next=7;break}return t.next=3,this.$message.confirm("该订单已发货成功，确定要再次发货?");case 3:if(n=t.sent,n.result){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,this.$post("orders/set",{id:e.id,state:a,send:r},{loading:!0});case 9:(i=t.sent).msg?this.$message.alert(m()(i.msg),"发货接口报错"):this.$message.alert("发货成功"),i.ret&&(e.ret=i.ret),e.state=a;case 13:case"end":return t.stop()}},t,this)}));return function(e,a,r){return t.apply(this,arguments)}}()},{key:"onExt",value:function(){var t=f()(v.a.mark(function t(e){var a,r,n,i;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$prompt("修改附加信息",{inputValue:e.ext});case 2:if(a=t.sent,r=a.result,n=a.value,!r){t.next=11;break}return t.next=8,this.$post("orders/set",{id:e.id,ext:n},{loading:!0});case 8:(i=t.sent).msg?this.$message.alert(m()(i.msg),"接口报错"):this.$message.alert("修改成功"),e.ext=n;case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"refresh",value:function(){var t=f()(v.a.mark(function t(){var e,a,r,n,i,s,l,o,u,p,d,m,_;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.$refs.date.getRange(),a=e.min,r=e.max,n=E.a.clearNull({type:this.query.type,state:this.query.state,ret:this.query.ret,create_max:r,create_min:a}),t.next=4,this.$get("orders/search",n);case 4:for(i=t.sent,s=i.list,l=i.apps,E.a.leftJoin(s,l,"app"),o=!0,u=!1,p=void 0,t.prev=11,d=c()(s);!(o=(m=d.next()).done);o=!0)_=m.value,this.format(_);t.next=19;break;case 15:t.prev=15,t.t0=t.catch(11),u=!0,p=t.t0;case 19:t.prev=19,t.prev=20,!o&&d.return&&d.return();case 22:if(t.prev=22,!u){t.next=25;break}throw p;case 25:return t.finish(22);case 26:return t.finish(19);case 27:this.list=s;case 28:case"end":return t.stop()}},t,this,[[11,15,19,27],[20,,22,26]])}));return function(){return t.apply(this,arguments)}}()},{key:"mounted",value:function(){this.refresh()}},{key:"table_data",get:function(){var t=this.list.concat(),e=this.sort.name;if(e){var a="desc"==this.sort.order?-1:1;t.sort(function(t,r){var n=t[e]-r[e];if(n)return n*a})}return t}}]),e}(T.default),N=s.prototype,P="refresh",S=[n],j=o()(s.prototype,"refresh"),D=s.prototype,J={},Object.keys(j).forEach(function(t){J[t]=j[t]}),J.enumerable=!!J.enumerable,J.configurable=!!J.configurable,("value"in J||J.initializer)&&(J.writable=!0),J=S.slice().reverse().reduce(function(t,e){return e(N,P,t)||t},J),D&&void 0!==J.initializer&&(J.value=J.initializer?J.initializer.call(D):void 0,J.initializer=void 0),void 0===J.initializer&&(Object.defineProperty(N,P,J),J=null),i=s))||i),C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pages-orders"},[a("br"),t._v(" "),a("div",{staticStyle:{padding:"12px"}},[a("i-date-range",{ref:"date",attrs:{type:t.query.r,max:"now",all:""},on:{change:function(e){t.refresh()},"update:type":function(e){t.$set(t.query,"r",e)}}})],1),t._v(" "),a("div",{staticClass:"tar"},[a("mu-select",{staticStyle:{width:"8em","margin-right":"1em"},attrs:{label:"支付方式"},model:{value:t.query.type,callback:function(e){t.$set(t.query,"type",e)},expression:"query.type"}},[a("mu-option",{attrs:{label:"全部",value:null}}),t._v(" "),t._l(t.payType,function(t,e){return a("mu-option",{key:e,attrs:{label:t,value:e}})})],2),t._v(" "),a("mu-select",{staticStyle:{width:"8em","margin-right":"1em"},attrs:{label:"支付状态"},model:{value:t.query.state,callback:function(e){t.$set(t.query,"state",e)},expression:"query.state"}},[a("mu-option",{attrs:{label:"全部",value:null}}),t._v(" "),t._l(t.stateType,function(t,e){return a("mu-option",{key:e,attrs:{label:t,value:e}})})],2),t._v(" "),a("mu-select",{staticStyle:{width:"8em","margin-right":"1em"},attrs:{label:"发货状态"},model:{value:t.query.ret,callback:function(e){t.$set(t.query,"ret",e)},expression:"query.ret"}},[a("mu-option",{attrs:{label:"全部",value:null}}),t._v(" "),t._l(t.sendType,function(t,e){return a("mu-option",{key:e,attrs:{label:t,value:e}})})],2),t._v(" "),a("mu-button",{attrs:{color:"primary"},on:{click:t.refresh}},[t._v("搜索")])],1),t._v(" "),a("div",[t._v("最多显示1000条")]),t._v(" "),a("mu-paper",{attrs:{"z-depth":1}},[a("mu-data-table",{attrs:{loading:t.loading,columns:t.columns,data:t.table_data,sort:t.sort},on:{"update:sort":function(e){t.sort=e}},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("td",[t._v(t._s(r.id))]),t._v(" "),a("td",[t._v(t._s(r.ip))]),t._v(" "),a("td",[a("span",{attrs:{title:r.ua}},[t._v(t._s(r.os))])]),t._v(" "),a("td",[t._v(t._s(r.app.title))]),t._v(" "),a("td",[t._v(t._s(t.payType[r.type]))]),t._v(" "),a("td",[t._v(t._s(r.price?r.price:"不设"))]),t._v(" "),a("td",[a("i-date",{attrs:{value:r.create_at,digits:1}})],1),t._v(" "),a("td",[r.pay_at?a("span",[t._v("\n\t\t\t\t\t\t"+t._s(t._f("diff")(r.pay_at-r.create_at))+"后\n\t\t\t\t\t")]):t._e()]),t._v(" "),a("td",[t._v(t._s(t.stateType[r.state||0]))]),t._v(" "),a("td",[t._v(t._s(2==r.state?t.sendType[r.ret||0]:""))]),t._v(" "),a("td",[t._v(t._s(r.ext))]),t._v(" "),a("td",[a("mu-menu",{attrs:{cover:"",placement:"bottom-end"}},[a("mu-icon",{attrs:{value:"more_vert"}}),t._v(" "),a("mu-list",{attrs:{slot:"content"},slot:"content"},[a("mu-list-item",{directives:[{name:"show",rawName:"v-show",value:!r.app_id,expression:"!row.app_id"}],attrs:{button:""},on:{click:function(e){t.onOk(r,2)}}},[a("mu-list-item-title",[t._v("确认")])],1),t._v(" "),a("mu-list-item",{directives:[{name:"show",rawName:"v-show",value:!r.app_id,expression:"!row.app_id"}],attrs:{button:""},on:{click:function(e){t.onOk(r,2,1)}}},[a("mu-list-item-title",[t._v("已发货")])],1),t._v(" "),a("mu-list-item",{directives:[{name:"show",rawName:"v-show",value:r.app_id,expression:"row.app_id"}],attrs:{button:""},on:{click:function(e){t.onExt(r)}}},[a("mu-list-item-title",[t._v("修改附加信息")])],1),t._v(" "),a("mu-list-item",{directives:[{name:"show",rawName:"v-show",value:r.app_id,expression:"row.app_id"}],attrs:{button:""},on:{click:function(e){t.onOk(r,2,1)}}},[a("mu-list-item-title",[t._v("确认并发货")])],1),t._v(" "),a("mu-list-item",{attrs:{button:""},on:{click:function(e){t.onOk(r,1)}}},[a("mu-list-item-title",[t._v("支付失败")])],1)],1)],1)],1)]}}])})],1)],1)},staticRenderFns:[]};var G=a("VU/8")(A,C,!1,function(t){a("mD5l")},null,null);e.default=G.exports}});