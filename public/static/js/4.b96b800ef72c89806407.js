webpackJsonp([4],{YFdP:function(e,t){},xMvJ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),o=a.n(r),s=a("exGp"),l=a.n(s),n=a("woOf"),i=a.n(n),u=a("Dd8w"),m=a.n(u),c=a("NYxO"),f=a("JaHG"),d={name:"UserEdit",data:function(){return{tab:0,form:{passwd0:"",passwd:""},v0:!1,v1:!1,email:{open:!1,title:"",err:"",c:"",s:0,loading:!1},tel:{open:!1,title:"",err:"",c:"",s:0,loading:!1},rule:{email:f.a.rule("need","email"),tel:f.a.rule("need","tel"),need:f.a.rule("need")}}},computed:m()({},Object(c.e)({user:function(e){return e.user.user}}),{email_disable:function(){return Boolean(this.email.s||!f.a.isEmail(this.email.title))},tel_disable:function(){return Boolean(this.tel.s)}}),watch:{user:function(){this.form=i()({},this.user)}},methods:{sendCode:function(e){var t=this;return l()(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$get("user/code_send",e,{loading:!0});case 2:e.s=61,function t(){e.s--,e.s>0&&setTimeout(t,1e3)}();case 5:case"end":return a.stop()}},a,t)}))()},changeEmail:function(e){var t=this;return l()(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$refs.email.validate();case 2:if(a.sent){a.next=5;break}return a.abrupt("return");case 5:return a.next=7,t.$post("user/edit",{email:e.title,ecode:e.c},{loading:!0});case 7:t.$store.commit("user.user",i()({},t.user,{email:e.title})),e.open=!1;case 9:case"end":return a.stop()}},a,t)}))()},changeTel:function(e){var t=this;return l()(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$refs.tel.validate();case 2:if(a.sent){a.next=5;break}return a.abrupt("return");case 5:return a.next=7,t.$post("user/edit",{tel:e.title,tcode:e.c},{loading:!0});case 7:t.$store.commit("user.user",i()({},t.user,{tel:e.title})),e.open=!1;case 9:case"end":return a.stop()}},a,t)}))()},change:function(e){var t=this;return l()(o.a.mark(function e(){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.form.validate();case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return(a=f.a.clearKeys(t.form,t.user)).birth_at&&(a.birth_at=+a.birth_at),e.next=9,t.$post("user/edit",a,{loading:!0});case 9:delete a.passwd,delete a.passwd0,t.$store.commit("user.user",i()({},t.user,a)),t.$toast.success("修改成功"),t.form=i()({},t.user);case 14:case"end":return e.stop()}},e,t)}))()}},components:{},mounted:function(){this.form=i()({},this.user)}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pages-user-edit"},[a("mu-tabs",{attrs:{value:e.tab,inverse:"",center:""},on:{"update:value":function(t){e.tab=t}}},[a("mu-tab",[e._v("个人信息")]),e._v(" "),a("mu-tab",[e._v("修改密码")])],1),e._v(" "),a("mu-form",{directives:[{name:"show",rawName:"v-show",value:0==e.tab,expression:"tab==0"}],ref:"form",staticClass:"mu-demo-form",attrs:{model:e.form,"label-position":"left","label-width":"100"}},[a("mu-form-item",{attrs:{prop:"name",label:"昵称",rules:e.rule.need}},[a("mu-text-field",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("mu-form-item",{attrs:{label:"邮箱"}},[a("span",[e._v(e._s(e.form.email))]),e.form.email?a("span",[e._v("  ")]):e._e(),a("a",{on:{click:function(t){e.email.open=!0}}},[e._v(e._s(e.form.email?"修改":"绑定"))])]),e._v(" "),a("mu-form-item",{attrs:{prop:"birth_at",label:"生日"}},[a("mu-date-input",{attrs:{type:"date",actions:""},model:{value:e.form.birth_at,callback:function(t){e.$set(e.form,"birth_at",t)},expression:"form.birth_at"}})],1),e._v(" "),a("mu-form-item",{attrs:{prop:"sex",label:"性别"}},[a("mu-radio",{attrs:{value:1,label:"男"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}}),e._v(" "),a("mu-radio",{attrs:{value:2,label:"女"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}}),e._v(" "),a("mu-radio",{attrs:{value:0,label:"不告诉你"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}})],1),e._v(" "),a("mu-form-item",{attrs:{prop:"profile",label:"简介"}},[a("mu-text-field",{attrs:{"multi-line":"",rows:3,"rows-max":6},model:{value:e.form.profile,callback:function(t){e.$set(e.form,"profile",t)},expression:"form.profile"}})],1),e._v(" "),a("mu-form-item",[a("mu-button",{attrs:{color:"primary"},on:{click:function(t){e.change()}}},[e._v("保存")])],1)],1),e._v(" "),a("mu-form",{directives:[{name:"show",rawName:"v-show",value:1==e.tab,expression:"tab==1"}],ref:"form",staticClass:"mu-demo-form",attrs:{model:e.form,"label-position":"left","label-width":"100"}},[a("mu-form-item",{attrs:{prop:"passwd0",label:"旧密码",rules:e.rule.passwd}},[a("mu-text-field",{attrs:{"action-icon":e.v0?"visibility_off":"visibility","action-click":function(){return e.v0=!e.v0},type:e.v0?"text":"password"},model:{value:e.form.passwd0,callback:function(t){e.$set(e.form,"passwd0",t)},expression:"form.passwd0"}})],1),e._v(" "),a("mu-form-item",{attrs:{prop:"passwd",label:"新密码",rules:e.rule.passwd}},[a("mu-text-field",{attrs:{"action-icon":e.v1?"visibility_off":"visibility","action-click":function(){return e.v1=!e.v1},type:e.v1?"text":"password"},model:{value:e.form.passwd,callback:function(t){e.$set(e.form,"passwd",t)},expression:"form.passwd"}})],1),e._v(" "),a("mu-form-item",[a("mu-button",{attrs:{color:"primary"},on:{click:function(t){e.change()}}},[e._v("保存")])],1)],1),e._v(" "),a("mu-dialog",{attrs:{title:"绑定邮箱",width:"360",open:e.email.open},on:{"update:open":function(t){e.$set(e.email,"open",t)}}},[a("mu-form",{ref:"email",attrs:{model:e.email,"label-position":"top"}},[a("mu-form-item",{attrs:{prop:"title",label:"邮箱",rules:e.rule.email}},[a("mu-text-field",{model:{value:e.email.title,callback:function(t){e.$set(e.email,"title",t)},expression:"email.title"}},[a("mu-button",{directives:[{name:"loading",rawName:"v-loading",value:e.email.loading,expression:"email.loading"}],attrs:{slot:"append",flat:"",disabled:e.email_disable},on:{click:function(t){e.sendCode(e.email)}},slot:"append"},[e._v(e._s(e.email.s?e.email.s+"秒":"获取验证码"))])],1)],1),e._v(" "),a("mu-form-item",{attrs:{prop:"c",label:"邮箱验证码",rules:e.rule.need}},[a("mu-text-field",{model:{value:e.email.c,callback:function(t){e.$set(e.email,"c",t)},expression:"email.c"}})],1)],1),e._v(" "),a("mu-button",{attrs:{slot:"actions",flat:""},on:{click:function(t){e.email.open=!1}},slot:"actions"},[e._v("取消")]),e._v(" "),a("mu-button",{attrs:{slot:"actions",flat:"",color:"primary"},on:{click:function(t){e.changeEmail(e.email)}},slot:"actions"},[e._v("确定")])],1),e._v(" "),a("mu-dialog",{ref:"tel",attrs:{title:"绑定手机号",width:"360",open:e.tel.open},on:{"update:open":function(t){e.$set(e.tel,"open",t)}}},[a("mu-form",{attrs:{model:e.tel,"label-position":"top"}},[a("mu-form-item",{attrs:{prop:"title",label:"手机号",rules:e.rule.tel}},[a("mu-text-field",{model:{value:e.tel.title,callback:function(t){e.$set(e.tel,"title",t)},expression:"tel.title"}},[a("mu-button",{directives:[{name:"loading",rawName:"v-loading",value:e.tel.loading,expression:"tel.loading"}],attrs:{slot:"append",flat:"",disabled:e.tel_disable},on:{click:function(t){e.sendCode(e.tel)}},slot:"append"},[e._v(e._s(e.tel.s?e.tel.s+"秒":"获取验证码"))])],1)],1),e._v(" "),a("mu-form-item",{attrs:{prop:"c",label:"手机验证码",rules:e.rule.need}},[a("mu-text-field",{model:{value:e.tel.c,callback:function(t){e.$set(e.tel,"c",t)},expression:"tel.c"}})],1)],1),e._v(" "),a("mu-button",{attrs:{slot:"actions",flat:""},on:{click:function(t){e.tel.open=!1}},slot:"actions"},[e._v("取消")]),e._v(" "),a("mu-button",{attrs:{slot:"actions",flat:"",color:"primary"},on:{click:function(t){e.changeTel(e.tel)}},slot:"actions"},[e._v("确定")])],1)],1)},staticRenderFns:[]};var v=a("VU/8")(d,p,!1,function(e){a("YFdP")},null,null);t.default=v.exports}});